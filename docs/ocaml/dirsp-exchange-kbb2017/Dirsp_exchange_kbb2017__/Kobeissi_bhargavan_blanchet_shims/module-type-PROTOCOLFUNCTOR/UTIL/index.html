<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>UTIL (dirsp-exchange-kbb2017.Dirsp_exchange_kbb2017__.Kobeissi_bhargavan_blanchet_shims.PROTOCOLFUNCTOR.UTIL)</title><link rel="stylesheet" href="../../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">dirsp-exchange-kbb2017</a> &#x00BB; <a href="../../../index.html">Dirsp_exchange_kbb2017__</a> &#x00BB; <a href="../../index.html">Kobeissi_bhargavan_blanchet_shims</a> &#x00BB; <a href="../index.html">PROTOCOLFUNCTOR</a> &#x00BB; UTIL</nav><h1>Module <code>PROTOCOLFUNCTOR.UTIL</code></h1><p>Cryptographic helpers used in KBB2017</p></header><dl><dt class="spec value" id="val-xHKDF"><a href="#val-xHKDF" class="anchor"></a><code><span class="keyword">val</span> xHKDF : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> array</span></code></dt><dd><p><code>xHKDF ikm salt info</code> extracts a pseudo-random key from the input keying material <code>ikm</code> and a <code>salt</code> and expands it to derive two derivative keys from an optional application- and context-specific <code>info</code> using the <a href="https://tools.ietf.org/html/rfc5869">RFC 5869 HMAC-based Extract-and-Expand Key Derivation Function</a> construction.</p><dl><dt>returns</dt><dd><p>an array <code> [| k0; k1 |] </code> where <code>k0</code> is the derivative key from the first expansion and <code>k1</code> is the derivative key from the second expansion</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-xQDHInit"><a href="#val-xQDHInit" class="anchor"></a><code><span class="keyword">val</span> xQDHInit : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a></code></dt><dd><p><code>xQDHInit myIdentityKeyPriv myInitEphemeralKeyPriv theirIdentityKeyPub theirSignedPreKeyPub theirPreKeyPub</code> performs the <a href="https://signal.org/docs/specifications/x3dh/#sending-the-initial-message">quad Diffie-Helman construction for &quot;Sending the initial message&quot; of the X3DH Key Agreement Protocol</a>.</p></dd></dl><dl><dt class="spec value" id="val-xQDHResp"><a href="#val-xQDHResp" class="anchor"></a><code><span class="keyword">val</span> xQDHResp : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a></code></dt><dd><p><code>xQDHInit myIdentityKeyPriv mySignedPreKeyPriv myPreKeyPriv theirIdentityKeyPub theirEphemeralKeyPub</code> performs the <a href="https://signal.org/docs/specifications/x3dh/#receiving-the-initial-message">quad Diffie-Helman construction for &quot;Receiving the initial message&quot; of the X3DH Key Agreement Protocol</a>.</p></dd></dl><dl><dt class="spec value" id="val-newIdentityKey"><a href="#val-newIdentityKey" class="anchor"></a><code><span class="keyword">val</span> newIdentityKey : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_keypair">record_keypair</a></span></code></dt><dd><p><code>newIdentityKey id</code> creates a key pair with a randomly initialized 32 byte private key and its 32 bytes ED25519 public key.</p><p><code>id</code> will be ignored for a true random number generator. But <code>id</code> may be used for mock random number generators or pseudo random generators to provide repeatability.</p></dd></dl><dl><dt class="spec value" id="val-newKeyPair"><a href="#val-newKeyPair" class="anchor"></a><code><span class="keyword">val</span> newKeyPair : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_keypair">record_keypair</a></span></code></dt><dd><p><code>newKeyPair id</code> creates a key pair with a randomly initialized 32 byte private key and its 32 byte DH25519 (aka x25519) public key.</p><p><code>id</code> will be ignored for a true random number generator. But <code>id</code> may be used for mock random number generators or pseudo random generators to provide repeatability.</p></dd></dl><dl><dt class="spec value" id="val-getDHPublicKey"><a href="#val-getDHPublicKey" class="anchor"></a><code><span class="keyword">val</span> getDHPublicKey : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a></code></dt><dd><p><code>getDHPublicKey priv</code> gives the DH25519 public key corresponding to the private key <code>priv</code></p></dd></dl></div></body></html>