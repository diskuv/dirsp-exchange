<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>TOPLEVEL (dirsp-exchange-kbb2017.Dirsp_exchange_kbb2017__Kobeissi_bhargavan_blanchet_shims.PROTOCOLFUNCTOR.TOPLEVEL)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">dirsp-exchange-kbb2017</a> &#x00BB; <a href="../../index.html">Dirsp_exchange_kbb2017__Kobeissi_bhargavan_blanchet_shims</a> &#x00BB; <a href="../index.html">PROTOCOLFUNCTOR</a> &#x00BB; TOPLEVEL</nav><h1>Module <code>PROTOCOLFUNCTOR.TOPLEVEL</code></h1><p>Entry point for sending and receiving messages while maintaining a KBB2017 session.</p></header><dl><dt class="spec value" id="val-newSession"><a href="#val-newSession" class="anchor"></a><code><span class="keyword">val</span> newSession : <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_keypair">record_keypair</a></span> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_keypair">record_keypair</a></span> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_them">record_them</a></span></code></dt><dd><p><code>newSession mySignedPreKey myPreKey theirIdentityKeyPub theirIdentityDHKeyPub theirSignedPreKeyPub theirSignedPreKeySignature theirPreKeyPub preKeyId</code> creates a KBB2017 session from &quot;my&quot; prekeys and &quot;their&quot; public information while consuming a one-time pre-key <code>preKeyId</code>.</p><p>Using nomenclature from the KBB2017 paper, the expectation is that the &quot;their&quot; party has published their long-term Diffie-Hellman public key <code>theirIdentityDHKeyPub</code> and a set of ephemeral Diffie-Hellman public keys (<code>theirSignedPreKeyPub</code> and <code>theirPreKeyPub</code>) called &quot;pre-keys&quot; to a common server or other shared location. The pre-keys include both signed pre-keys <code>mySignedPreKey</code>, which can be reused for some period of time, and non-signed, one-time pre-keys (<code>myPreKey</code> and their <code>preKeyId</code>), which are fresh at each session.</p></dd></dl><dl><dt class="spec value" id="val-send"><a href="#val-send" class="anchor"></a><code><span class="keyword">val</span> send : <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_keypair">record_keypair</a></span> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_them">record_them</a></span> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_sendoutput">record_sendoutput</a></span></code></dt><dd><p><code>send myIdentityKey them plaintext</code> sends a <code>plaintext</code> message to <code>them</code> authenticated by <code>myIdentityKey</code>.</p></dd></dl><dl><dt class="spec value" id="val-recv"><a href="#val-recv" class="anchor"></a><code><span class="keyword">val</span> recv : <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_keypair">record_keypair</a></span> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_keypair">record_keypair</a></span> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_them">record_them</a></span> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_msg">record_msg</a></span> <span>&#45;&gt;</span> <span><a href="../index.html#type-t">t</a> <a href="../../index.html#type-record_recvoutput">record_recvoutput</a></span></code></dt><dd><p><code>recv myIdentityKey mySignedPreKey them msg</code> receives an encrypted message <code>msg</code> that was ostensibly obtained from <code>them</code> and verifies that it was sent to the session both established with a pre-key signed with <code>mySignedPreKey</code> and authenticated with <code>myIdentityKey</code>.</p><dl><dt>returns</dt><dd><p>a <a href="../../index.html#type-record_recvoutput"><code>record_recvoutput</code></a> that, if and only if <code>return_value.output.valid</code> is true, will have valid plaintext</p></dd></dl></dd></dl></div></body></html>